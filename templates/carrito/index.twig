{# Enlazar este fichero con la plantilla correspondiente #}
{% extends 'layouts/users.twig' %}

{% block title %}
  Index carrito
{% endblock %}

{% block content %}
  <!-- Tabla responsive. Hace que puedas hacer scroll horizontal (dependiendo del table-responsive 
  introducido, te permitirá hacer scroll dependiendo del tamaño y cuando se pueda, es decir, cuando empieza
  a comerse contenido a partir de cierto tamaño) -->
  <div class="table-responsive">
    <table class="table table-striped table-responsive-md table-responsive-sm text-center mt-4 contenedorCentro">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Producto</th>
          <th scope="col">Cantidad</th>
          <th scope="col">Precio</th>
        </tr>
      </thead>
      <tbody>
        {# El set declara una variable que luego podremos utilizar #}
        {% set total = 0 %}
        {# Bucle en Twig #}
        {% for i in carrito %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>{{ i.nombre }}</td>
            <td>{{ i.cantidad }}</td>
            <td>{{ i.precio }}€</td>
            {# Suma que va calculando el total del carro #}
            {% set total = (i.precio * i.cantidad) + total %}
          </tr>
        {% else %}
          <li class="text-center mt-5 mb-5 list-unstyled">
            <em>No se encuentran productos</em>
          </li>
        {% endfor %}

        <tr>
          <td></td>
          <td></td>
          <th>Total:</th>
          <th>{{ total }}€</th>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="text-center">
    <a class="btn btn-danger col-4 col-sm-4 col-md-3 col-lg-2" href="{{ url }}carrito/deleteAll">Eliminar productos</a>
    <a class="btn btn-success col-4 col-sm-4 col-md-3 col-lg-2" href="{{ url }}pedidos/save">Finalizar compra</a>
  </div>
{% endblock %}
